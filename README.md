# RAG Pipeline

Retrieval-Augmented Generation (RAG) is an approach to enhance LLMs by retrieving relevant document chunks from external knowledge base through semantic similarity calculation. 

<p align="center">
  <img src="/assets/a.png" alt="RAG Pipeline">
</p>

A typical RAG workflow begins with the creation of an index comprising external sources. This index will later be used for retrieving relevant information through a retriever model based on a specific query. The final step involves a generator model, which combines the retrieved information with the query to produce the desired output.
 
### Indexing

The initial phase of this system starts with the cleaning and extraction of raw data in diverse formats like PDF, HTML, Word, and Markdown. These documents are converted into a uniform plain text format. Text segments are then organized into sentences or paragraphs (chunks) to facilitate more focused searches, allowing for the pinpointing of segments containing pertinent keywords.

Chunks are then encoded into vector representations using an embedding model and saved for later use.

### Retrieval

With a prompt, this RAG system employs the same encoding model utilized during the indexing phase to transform the query into a vector representation. It then computes the similarity scores between the query vector and the vector of chunks within the indexed corpus. It prioritizes and retrieves the top K chunks that demonstrate the greatest similarity to the query. These chunks are subsequently used as the expanded context in prompt.

### Generation
In generation phase an response is generated by LLM  that is both relevant to the query and reflective of the information found in the retrieved documents.

### Installation

1. **Clone the repository:** `git clone https://github.com/thlurte/rag-pipeline`
2. **Create a virtual environment:** `python -m venv venv`
2. **Install dependencies:** `pip install -r requirements.txt` 
3. **Set up your API key:**  Obtain a Google Generative AI API key and configure it in the `load_llm` class.

### Usage

Run the `main.py` script to test the RAG system with a sample PDF and query.

```bash
python main.py
```

### License
This project is licensed under the MIT License - see the LICENSE file for details.
